function validateTaskForm(e){const t=e.querySelector('input[name="text"]'),n=e.querySelector(".error-message");return t.value.trim()?(n.innerHTML="",t.classList.remove("border-red-500"),t.classList.add("border-[var(--inline-input-border)]"),!0):(n.innerHTML="Please enter a task description",t.classList.remove("border-[var(--inline-input-border)]"),t.classList.add("border-red-500"),t.focus(),!1)}document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("project-switcher-btn"),t=document.getElementById("project-switcher-dropdown"),n=document.getElementById("switcher-chevron"),s=document.getElementById("project-switcher-container");let o=!1;function l(){o=!o,o?(t.classList.remove("opacity-0","invisible","scale-95"),t.classList.add("opacity-100","visible","scale-100"),n.style.transform="rotate(180deg)",e.classList.add("ring-2","ring-[var(--primary-action-bg)]/20")):(t.classList.add("opacity-0","invisible","scale-95"),t.classList.remove("opacity-100","visible","scale-100"),n.style.transform="rotate(0deg)",e.classList.remove("ring-2","ring-[var(--primary-action-bg)]/20"))}function i(){o&&l()}e.addEventListener("click",function(e){e.stopPropagation(),l()}),document.addEventListener("click",function(e){s.contains(e.target)||i()}),document.addEventListener("keydown",function(e){"Escape"===e.key&&i()});t.querySelectorAll("a").forEach(e=>{e.addEventListener("mouseenter",function(){this.style.transform="translateX(2px)"}),e.addEventListener("mouseleave",function(){this.style.transform="translateX(0)"})});const c=document.getElementById("delete-task-modal"),r=document.getElementById("delete-modal-content"),a=document.getElementById("task-to-delete"),d=document.getElementById("delete-task-form"),u=document.getElementById("close-delete-modal"),m=document.getElementById("cancel-delete-task");let f=null,h=null;function v(){c.classList.add("opacity-0","invisible"),r.classList.remove("scale-100"),r.classList.add("scale-95"),f=null,h=null}document.addEventListener("click",function(e){if(e.target.closest(".delete-task-btn")){e.preventDefault();const t=e.target.closest(".delete-task-btn");!function(e,t,n){f=e,h=n,a.textContent=t,d.action=n,c.classList.remove("opacity-0","invisible"),r.classList.remove("scale-95"),r.classList.add("scale-100"),setTimeout(()=>m.focus(),100)}(t.dataset.taskId,t.dataset.taskText,t.dataset.deleteUrl)}}),u.addEventListener("click",v),m.addEventListener("click",v),c.addEventListener("click",function(e){e.target===c&&v()}),document.addEventListener("keydown",function(e){"Escape"!==e.key||c.classList.contains("invisible")||v()}),d.addEventListener("submit",function(e){if(e.preventDefault(),!f||!h)return;const t=d.querySelector('button[type="submit"]'),n=t.innerHTML;t.innerHTML='<i class="fas fa-spinner fa-spin mr-2"></i>Deleting...',t.disabled=!0,fetch(h,{method:"POST",headers:{"X-CSRFToken":document.querySelector("[name=csrfmiddlewaretoken]").value,"HX-Request":"true"}}).then(e=>{if(!e.ok)throw new Error("Delete failed");{const e=document.getElementById(`task-${f}`);e&&(e.style.transform="translateX(-100%)",e.style.opacity="0",setTimeout(()=>e.remove(),300)),v()}}).catch(e=>{console.error("Error deleting task:",e),alert("Failed to delete task. Please try again.")}).finally(()=>{t.innerHTML=n,t.disabled=!1})});const y=document.getElementById("modal"),L=document.getElementById("modal-content");function g(){document.querySelectorAll(".task-form").forEach(e=>{const t=e.querySelector('input[name="text"]');t&&e.addEventListener("htmx:afterRequest",function(n){if(n.detail.successful){t.value="",t.focus();const n=e.querySelector(".error-message");n&&(n.innerHTML="")}})})}function E(){const e=document.querySelector(".grid-container");if(!e)return;let t=null;function n(){const t=e.querySelector(".grid-table");if(!t)return;t.querySelectorAll("colgroup col.category-column");const n=t.querySelectorAll("colgroup col.data-column");if(0===n.length)return;const s=e.clientWidth,o=window.innerWidth;let l=300,i=380;o<=768?(l=150,i=320):o<=1024&&(i=350);const c=(s-l)/n.length;if(c>=i)t.style.width="100%",n.forEach(e=>{e.style.width=c+"px"});else{const e=l+n.length*i;t.style.width=e+"px",n.forEach(e=>{e.style.width=i+"px"})}}function s(){const e=window.innerWidth;return e<=768?320:e<=1024?350:380}function o(){if(!t)return;const n=document.querySelector(".grid-scroll-progress"),s=Math.round(e.scrollLeft),o=Math.round(e.scrollWidth-e.clientWidth),l=s>5,i=s<o-5;if(l?(t.leftBtn.classList.add("active"),t.leftBtn.disabled=!1):(t.leftBtn.classList.remove("active"),t.leftBtn.disabled=!0),i?(t.rightBtn.classList.add("active"),t.rightBtn.disabled=!1):(t.rightBtn.classList.remove("active"),t.rightBtn.disabled=!0),e.classList.toggle("can-scroll-left",l),e.classList.toggle("can-scroll-right",i),n){const e=o>0?s/o*100:0;n.style.width=Math.min(100,Math.max(0,e))+"%"}}n(),function(){const n=document.querySelector(".left-scroll-btn"),l=document.querySelector(".right-scroll-btn");if(!n||!l)return;t={leftBtn:n,rightBtn:l};const i=document.createElement("div");i.className="grid-scroll-progress-track";const c=document.createElement("div");c.className="grid-scroll-progress",c.style.width="0%",i.appendChild(c),e.parentElement.appendChild(i),n.addEventListener("click",()=>{const t=s(),n=e.scrollLeft,l=Math.max(0,Math.floor(n/t)*t-t);e.scrollTo({left:l,behavior:"smooth"}),setTimeout(o,50),setTimeout(o,300)}),l.addEventListener("click",()=>{const t=s(),n=e.scrollLeft,l=e.scrollWidth-e.clientWidth,i=Math.min(l,Math.ceil(n/t)*t+t);e.scrollTo({left:i,behavior:"smooth"}),setTimeout(o,50),setTimeout(o,300)})}(),o(),e.addEventListener("scroll",o),setTimeout(o,100),setTimeout(o,500),window.addEventListener("resize",function(){n(),setTimeout(o,100)}),e.addEventListener("keydown",function(t){if("ArrowLeft"===t.key&&t.ctrlKey){t.preventDefault();const n=s(),o=e.scrollLeft,l=Math.max(0,Math.floor(o/n)*n-n);e.scrollTo({left:l,behavior:"smooth"})}else if("ArrowRight"===t.key&&t.ctrlKey){t.preventDefault();const n=s(),o=e.scrollLeft,l=e.scrollWidth-e.clientWidth,i=Math.min(l,Math.ceil(o/n)*n+n);e.scrollTo({left:i,behavior:"smooth"})}}),e.tabIndex=0,e.style.outline="none",e.style.scrollBehavior="auto",e.addEventListener("wheel",function(e){Math.abs(e.deltaX)>Math.abs(e.deltaY)&&e.preventDefault()},{passive:!1})}document.body.addEventListener("openModal",function(){y.classList.remove("opacity-0","invisible"),y.classList.add("opacity-100","visible"),L.classList.remove("scale-95"),L.classList.add("scale-100")}),document.body.addEventListener("closeModal",function(){y.classList.add("opacity-0","invisible"),y.classList.remove("opacity-100","visible"),L.classList.add("scale-95"),L.classList.remove("scale-100")}),document.body.addEventListener("refreshGrid",function(){window.location.reload()}),y.addEventListener("click",function(e){e.target===y&&document.body.dispatchEvent(new Event("closeModal"))}),document.addEventListener("keydown",function(e){"Escape"!==e.key||y.classList.contains("invisible")||document.body.dispatchEvent(new Event("closeModal"))}),document.addEventListener("click",function(e){e.target.closest(".close-modal")&&document.body.dispatchEvent(new Event("closeModal"))}),g(),document.body.addEventListener("htmx:afterSwap",g),document.body.addEventListener("htmx:afterSettle",g),E(),document.body.addEventListener("htmx:afterSettle",function(){E(),setTimeout(()=>{const e=document.querySelector(".grid-container");if(e){(()=>{const t=e.querySelector(".grid-table");if(!t)return;t.querySelectorAll("colgroup col.category-column");const n=t.querySelectorAll("colgroup col.data-column");if(0===n.length)return;const s=e.clientWidth,o=window.innerWidth;let l=300,i=380;o<=768?(l=150,i=320):o<=1024&&(i=350);const c=(s-l)/n.length;if(c>=i)t.style.width="100%",n.forEach(e=>{e.style.width=c+"px"});else{const e=l+n.length*i;t.style.width=e+"px",n.forEach(e=>{e.style.width=i+"px"})}})()}},100)})});