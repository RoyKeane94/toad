class GridManager{constructor(){window.innerWidth<769?console.log("GridManager: Skipping initialization on mobile device"):(this.state={currentCol:0,dataColWidth:0,totalDataColumns:0,columnsToShow:3,isDropdownOpen:!1,currentTaskId:null,currentDeleteUrl:null},this.elements={},this.observers=new Map,this.eventListeners=new Map,this.init())}cacheElements(){const t={switcherBtn:"#project-switcher-btn",switcherDropdown:"#project-switcher-dropdown",switcherChevron:"#switcher-chevron",switcherContainer:"#project-switcher-container",scrollable:".grid-table-scrollable",leftBtn:".left-scroll-btn",rightBtn:".right-scroll-btn",gridTable:".grid-table",dataCols:"col.data-column",deleteModal:"#delete-task-modal",deleteModalContent:"#delete-modal-content",taskToDelete:"#task-to-delete",deleteTaskForm:"#delete-task-form",closeDeleteModal:"#close-delete-modal",cancelDeleteTask:"#cancel-delete-task",modal:"#modal",modalContent:"#modal-content",fixedRows:".grid-table-fixed tr",scrollRows:".grid-table-scrollable .grid-table tr",fixedTable:".grid-table-fixed",dataTable:".grid-table"};Object.keys(t).forEach(e=>{const s=t[e];s.includes("All")||e.includes("Rows")||"dataCols"===e?this.elements[e]=document.querySelectorAll(s):this.elements[e]=document.querySelector(s)})}addEventListeners(){[["document","click",this.handleDocumentClick.bind(this)],["document","keydown",this.handleKeydown.bind(this)],["document","htmx:beforeRequest",this.handleHtmxBeforeRequest.bind(this)],["document","htmx:afterRequest",this.handleHtmxAfterRequest.bind(this)],["document","htmx:afterSwap",this.handleHtmxAfterSwap.bind(this)],["document","htmx:afterSettle",this.handleHtmxAfterSettle.bind(this)],["document","htmx:responseError",this.handleHtmxError.bind(this)],["document","htmx:sendError",this.handleHtmxError.bind(this)],["window","resize",this.handleWindowResize.bind(this)],["body","openModal",this.showModal.bind(this)],["body","closeModal",this.hideModal.bind(this)],["body","refreshGrid",this.handleRefreshGrid.bind(this)],["body","scrollToEnd",this.handleScrollToEnd.bind(this)],["body","resetGridToInitial",this.handleResetGridToInitial.bind(this)]].forEach(([t,e,s])=>{const o="document"===t?document:"window"===t?window:document.body;o.addEventListener(e,s),this.eventListeners.has(o)||this.eventListeners.set(o,[]),this.eventListeners.get(o).push({event:e,handler:s})}),document.addEventListener("scrollToEnd",t=>{this.handleScrollToEnd()}),document.addEventListener("htmx:trigger",t=>{"scrollToEnd"===t.detail.trigger&&this.handleScrollToEnd()}),document.body.addEventListener("htmx:afterRequest",t=>{if(t.detail.xhr&&t.detail.xhr.getResponseHeader("HX-Trigger")){const e=t.detail.xhr.getResponseHeader("HX-Trigger");e&&e.includes("scrollToEnd")&&this.handleScrollToEnd()}})}handleDocumentClick(t){if(t.target.closest('[hx-target="#modal-content"]')&&(this.clearModalContent(),this.showModal()),t.target.closest("#project-switcher-btn"))return t.stopPropagation(),void this.toggleProjectSwitcher();t.target.closest("#project-switcher-container")||this.closeProjectSwitcher();const e=t.target.closest(".column-actions-btn, .row-actions-btn");if(e)return t.stopPropagation(),void this.toggleActionDropdown(e);t.target.closest(".column-actions-dropdown, .row-actions-dropdown")||this.closeAllActionDropdowns();const s=t.target.closest(".delete-task-btn");if(s)return t.preventDefault(),void this.showDeleteModal(s.dataset.taskId,s.dataset.taskText,s.dataset.deleteUrl);const o=t.target.closest(".close-modal, #close-delete-modal, #cancel-delete-task");if(o)return void("close-delete-modal"===o.id||"cancel-delete-task"===o.id?this.hideDeleteModal():o.classList.contains("close-modal")&&this.hideModal());t.target===this.elements.deleteModal&&this.hideDeleteModal(),t.target===this.elements.modal&&this.hideModal();const l=t.target.closest(".add-task-trigger");if(l)return t.preventDefault(),void this.expandAddTaskForm(l.closest(".add-task-form"));const i=t.target.closest(".add-task-cancel");if(i)return t.preventDefault(),void this.collapseAddTaskForm(i.closest(".add-task-form"));t.target.closest(".add-task-form")||this.collapseAllAddTaskForms();const a=t.target.closest('input[type="checkbox"][name="completed"]');if(a){const t=a.closest("form");if(t&&t.hasAttribute("hx-post")){const t=a.id.replace("checkbox-",""),e=document.getElementById(`task-text-${t}`);e&&(a.checked?(a.classList.add("checkbox-completed"),e.classList.add("task-completed-strikethrough")):(a.classList.remove("checkbox-completed"),e.classList.remove("task-completed-strikethrough")))}}}handleKeydown(t){"Escape"===t.key&&(this.closeProjectSwitcher(),this.closeAllActionDropdowns(),this.hideDeleteModal(),this.hideModal(),this.collapseAllAddTaskForms())}toggleProjectSwitcher(){this.elements.switcherDropdown&&(this.state.isDropdownOpen=!this.state.isDropdownOpen,this.updateProjectSwitcherUI())}closeProjectSwitcher(){this.state.isDropdownOpen&&(this.state.isDropdownOpen=!1,this.updateProjectSwitcherUI())}updateProjectSwitcherUI(){const{switcherDropdown:t,switcherChevron:e,switcherBtn:s}=this.elements;if(!t)return;const o=this.state.isDropdownOpen?{remove:["opacity-0","invisible","scale-95"],add:["opacity-100","visible","scale-100"]}:{remove:["opacity-100","visible","scale-100"],add:["opacity-0","invisible","scale-95"]};t.classList.remove(...o.remove),t.classList.add(...o.add),e&&(e.style.transform=this.state.isDropdownOpen?"rotate(180deg)":"rotate(0deg)"),s&&(s.classList.toggle("ring-2",this.state.isDropdownOpen),s.classList.toggle("ring-[var(--primary-action-bg)]/20",this.state.isDropdownOpen))}toggleActionDropdown(t){const e=t.nextElementSibling;if(!e)return;this.closeAllActionDropdowns(e);const s=!e.classList.contains("opacity-0");this.setDropdownState(e,!s)}closeAllActionDropdowns(t=null){document.querySelectorAll(".column-actions-dropdown, .row-actions-dropdown").forEach(e=>{e!==t&&this.setDropdownState(e,!1)})}closeAllDropdowns(){this.closeProjectSwitcher(),this.closeAllActionDropdowns()}setDropdownState(t,e){const s=e?{remove:["opacity-0","invisible","scale-95"],add:["opacity-100","visible","scale-100"]}:{remove:["opacity-100","visible","scale-100"],add:["opacity-0","invisible","scale-95"]};t.classList.remove(...s.remove),t.classList.add(...s.add)}showDeleteModal(t,e,s){this.state.currentTaskId=t,this.state.currentDeleteUrl=s,this.elements.taskToDelete&&(this.elements.taskToDelete.textContent=e),this.elements.deleteTaskForm&&(this.elements.deleteTaskForm.action=s,this.elements.deleteTaskForm.setAttribute("hx-post",s),"undefined"!=typeof htmx&&htmx.process(this.elements.deleteTaskForm)),this.setModalState(this.elements.deleteModal,this.elements.deleteModalContent,!0),setTimeout(()=>this.elements.cancelDeleteTask?.focus(),100)}hideDeleteModal(){this.setModalState(this.elements.deleteModal,this.elements.deleteModalContent,!1),this.state.currentTaskId=null,this.state.currentDeleteUrl=null}showModal(){this.setModalState(this.elements.modal,this.elements.modalContent,!0)}hideModal(){this.setModalState(this.elements.modal,this.elements.modalContent,!1)}clearModalContent(){this.elements.modalContent&&(this.elements.modalContent.innerHTML='\n                <div class="flex items-center justify-center p-8">\n                    <div class="flex items-center space-x-3">\n                        <div class="animate-spin w-6 h-6 border-2 border-[var(--primary-action-bg)] border-t-transparent rounded-full"></div>\n                        <span class="text-[var(--text-secondary)]">Loading...</span>\n                    </div>\n                </div>\n            ')}setModalState(t,e,s){t&&e&&(s?(t.classList.remove("opacity-0","invisible"),t.classList.add("opacity-100","visible"),e.classList.remove("scale-95"),e.classList.add("scale-100")):(t.classList.add("opacity-0","invisible"),t.classList.remove("opacity-100","visible"),e.classList.add("scale-95"),e.classList.remove("scale-100")))}expandAddTaskForm(t){if(!t)return;const e=t.querySelector(".add-task-collapsed"),s=t.querySelector(".add-task-expanded"),o=t.querySelector('input[name="text"]');e&&s&&(e.style.display="none",s.classList.remove("hidden"),setTimeout(()=>o?.focus(),100))}collapseAddTaskForm(t){if(!t)return;const e=t.querySelector(".add-task-collapsed"),s=t.querySelector(".add-task-expanded"),o=t.querySelector('input[name="text"]'),l=t.querySelector(".error-message");e&&s&&(e.style.display="block",s.classList.add("hidden"),o&&(o.value="",o.classList.remove("border-red-500"),o.classList.add("border-[var(--inline-input-border)]")),l&&(l.innerHTML=""))}collapseAllAddTaskForms(){document.querySelectorAll(".add-task-form").forEach(t=>{this.collapseAddTaskForm(t)})}getResponsiveColumnCount(){const t=window.innerWidth;return t<=480?1:t<=768?2:3}setupGridScrolling(t=!1){const{scrollable:e,leftBtn:s,rightBtn:o,gridTable:l}=this.elements;if(!(e&&s&&o&&l))return console.warn("Grid elements not found, retrying..."),void setTimeout(()=>{this.cacheElements(),this.setupGridScrolling(t)},100);const i=document.querySelectorAll(".data-column");if(this.elements.dataCols=i,i.length){if(this.state.totalDataColumns=parseInt(l.dataset.totalDataColumns)||i.length,this.state.columnsToShow=Math.min(this.getResponsiveColumnCount(),this.state.totalDataColumns),s.onclick||(s.onclick=()=>this.scrollToCol(this.state.currentCol-1),o.onclick=()=>this.scrollToCol(this.state.currentCol+1),s.addEventListener("touchstart",t=>{t.preventDefault(),this.scrollToCol(this.state.currentCol-1)}),o.addEventListener("touchstart",t=>{t.preventDefault(),this.scrollToCol(this.state.currentCol+1)})),!this.observers.has("resize")){const t=new ResizeObserver(()=>{const t=e.scrollLeft,s=this.getResponsiveColumnCount();s!==this.state.columnsToShow&&(this.state.columnsToShow=Math.min(s,this.state.totalDataColumns),this.state.currentCol=Math.min(this.state.currentCol,Math.max(0,this.state.totalDataColumns-this.state.columnsToShow))),this.calculateAndApplyWidths(),e.scrollLeft=t,this.updateScrollButtons()});t.observe(e),this.observers.set("resize",t)}if(!this.observers.has("scroll")){const t=()=>{if(this.state.dataColWidth>0){const t=Math.round(e.scrollLeft/this.state.dataColWidth);t!==this.state.currentCol&&(this.state.currentCol=t,this.updateScrollButtons())}};e.addEventListener("scroll",t,{passive:!0}),this.observers.set("scroll",{disconnect:()=>e.removeEventListener("scroll",t)})}this.calculateAndApplyWidths(),this.updateScrollButtons(),t||this.restoreScrollPosition(),this.elements.gridTable&&this.elements.gridTable.classList.add("initialized")}else console.warn("No data columns found")}calculateAndApplyWidths(){const{scrollable:t,gridTable:e,dataCols:s}=this.elements;if(t&&s.length){if(this.state.columnsToShow>0){let o=t.clientWidth/this.state.columnsToShow;const l=250;o<l&&(o=l),this.state.dataColWidth=o,s.forEach((t,e)=>{const s=0===e?Math.max(o,300):o,i=0===e?"300px":`${l}px`;t.style.width=`${s}px`,t.style.minWidth=i});const i=this.state.dataColWidth*this.state.totalDataColumns;e.style.width=`${i}px`}this.syncRowHeights()}}scrollToCol(t,e="smooth"){const{scrollable:s}=this.elements;if(!s)return;this.state.currentCol=Math.max(0,Math.min(t,this.state.totalDataColumns-this.state.columnsToShow));const o=this.state.currentCol*this.state.dataColWidth;s.scrollTo({left:o,behavior:e}),this.updateScrollButtons()}updateScrollButtons(){const{leftBtn:t,rightBtn:e}=this.elements;t&&e&&(this.state.totalDataColumns<=this.state.columnsToShow?(t.disabled=e.disabled=!0,t.style.display=e.style.display="none"):(t.style.display=e.style.display="flex",t.disabled=0===this.state.currentCol,e.disabled=this.state.currentCol>=this.state.totalDataColumns-this.state.columnsToShow))}syncRowHeights(){const{fixedRows:t,scrollRows:e}=this.elements;if(t.length===e.length)for(let s=0;s<t.length;s++){const o=t[s].querySelector("td, th"),l=e[s].querySelector("td, th");if(o&&l){o.style.height=l.style.height="auto";const t=Math.max(o.offsetHeight,l.offsetHeight);o.style.height=l.style.height=`${t}px`}}}restoreScrollPosition(){const t=sessionStorage.getItem("scrollToEnd"),e=sessionStorage.getItem("grid-scroll-position");if(sessionStorage.getItem("resetToInitial"))return sessionStorage.removeItem("resetToInitial"),this.state.currentCol=0,void this.scrollToCol(0,"auto");if(t)sessionStorage.removeItem("scrollToEnd"),setTimeout(()=>{const t=document.querySelectorAll(".data-column").length;if(t>0){this.state.totalDataColumns=t,this.elements.gridTable&&(this.elements.gridTable.dataset.totalDataColumns=t),this.calculateAndApplyWidths();const e=Math.max(0,this.state.totalDataColumns-this.state.columnsToShow);this.scrollToCol(e,"smooth")}else this.scrollToCol(0,"auto")},200);else if(e){sessionStorage.removeItem("grid-scroll-position");const t=parseFloat(e);this.elements.scrollable&&t>0&&setTimeout(()=>{this.elements.scrollable.scrollLeft=t,this.state.currentCol=this.state.dataColWidth>0?Math.round(t/this.state.dataColWidth):0,this.updateScrollButtons()},50)}else this.state.currentCol=0,this.elements.scrollable&&(this.elements.scrollable.scrollLeft=0,setTimeout(()=>{0!==this.elements.scrollable.scrollLeft&&(this.elements.scrollable.scrollLeft=0)},10)),this.updateScrollButtons()}handleScrollToEnd(){sessionStorage.setItem("scrollToEnd","true"),window.location.reload()}handleRefreshGrid(){this.elements.scrollable&&sessionStorage.setItem("grid-scroll-position",this.elements.scrollable.scrollLeft.toString()),window.location.reload()}handleResetGridToInitial(){sessionStorage.removeItem("grid-scroll-position"),sessionStorage.removeItem("scrollToEnd"),sessionStorage.setItem("resetToInitial","true"),this.state.currentCol=0,this.elements.scrollable&&(this.elements.scrollable.scrollLeft=0),window.location.reload()}handleWindowResize(){this.resizeTimeout&&clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(()=>{const t=this.getResponsiveColumnCount();t!==this.state.columnsToShow&&(this.state.columnsToShow=Math.min(t,this.state.totalDataColumns),this.state.currentCol=Math.min(this.state.currentCol,Math.max(0,this.state.totalDataColumns-this.state.columnsToShow)),this.calculateAndApplyWidths(),this.updateScrollButtons())},100)}updateColumnHeader(t,e){document.querySelectorAll(`[data-column-id="${t}"]`).forEach(t=>{const s=t.querySelector("span.font-semibold");s&&(s.textContent=e)})}updateRowHeader(t,e){document.querySelectorAll(`[data-row-id="${t}"]`).forEach(t=>{const s=t.querySelector("span.font-semibold");s&&(s.textContent=e)})}handleHtmxBeforeRequest(t){}handleHtmxAfterRequest(t){const e=t.detail.requestConfig?.url||t.target?.getAttribute("hx-post")||t.target?.getAttribute("hx-get")||"unknown",s=t.detail.requestConfig?.verb||t.detail.requestConfig?.type||(t.target?.getAttribute("hx-post")?"post":t.target?.getAttribute("hx-get")?"get":"unknown");if(t.detail.successful&&t.detail.xhr){const e=t.detail.xhr.getResponseHeader("HX-Trigger");if(e){if(e.includes("scrollToEnd"))return void this.handleScrollToEnd();if(e.includes("refreshGrid"))return void this.handleRefreshGrid();if(e.includes("resetGridToInitial"))return void this.handleResetGridToInitial()}}if(t.detail.successful&&("post"===s||"POST"===s)&&t.detail.xhr.responseText){const s=document.querySelector(".grid-table-scrollable"),o=s?s.scrollLeft:0;try{const l=JSON.parse(t.detail.xhr.responseText);if(l.success){if(e.includes("/columns/")&&e.includes("/edit/")||e.match(/\/columns\/\d+\/edit\//)){let t=null;const i=e.match(/\/columns\/(\d+)\//);if(i)t=i[1];else{const s=e.split("/"),o=s.indexOf("columns");o>=0&&o+1<s.length&&(t=s[o+1])}if(t&&l.column_name)return this.updateColumnHeader(t,l.column_name),this.hideModal(),void setTimeout(()=>{s&&(s.scrollLeft=o,this.state.dataColWidth>0&&(this.state.currentCol=Math.round(o/this.state.dataColWidth),this.updateScrollButtons()))},50)}if(e.includes("/rows/")&&e.includes("/edit/")||e.match(/\/rows\/\d+\/edit\//)){let t=null;const i=e.match(/\/rows\/(\d+)\//);if(i)t=i[1];else{const s=e.split("/"),o=s.indexOf("rows");o>=0&&o+1<s.length&&(t=s[o+1])}if(t&&l.row_name)return this.updateRowHeader(t,l.row_name),this.hideModal(),void setTimeout(()=>{s&&(s.scrollLeft=o,this.state.dataColWidth>0&&(this.state.currentCol=Math.round(o/this.state.dataColWidth),this.updateScrollButtons()))},50)}}}catch(t){}}if(t.detail.successful&&"delete-task-form"===t.target.id&&"post"===t.detail.requestConfig.verb){const t=this.state.currentTaskId;if(t){const e=document.getElementById(`task-${t}`);if(e){const t=document.querySelector(".grid-table-scrollable"),s=t?t.scrollLeft:0;e.style.transition="all 0.3s ease",e.style.opacity="0",e.style.transform="scale(0.95)",setTimeout(()=>{e.remove(),t&&s>0&&(t.scrollLeft=s),setTimeout(()=>{this.syncRowHeights(),t&&s>0&&(t.scrollLeft=s,this.state.dataColWidth>0&&(this.state.currentCol=Math.round(s/this.state.dataColWidth),this.updateScrollButtons()))},10)},300)}}return void this.hideDeleteModal()}if(!t.detail.successful&&"delete-task-form"===t.target.id&&"post"===t.detail.requestConfig.verb)return void alert("Failed to delete task. Please try again.");if(t.detail.successful&&t.target.closest("#modal-content")&&"post"===t.detail.requestConfig.verb){let e=null;try{e=JSON.parse(t.detail.xhr.response)}catch(t){return void window.location.reload()}const s=document.getElementById("modal"),o=document.getElementById("modal-content");s.classList.add("opacity-0","invisible"),o.classList.remove("scale-100"),o.classList.add("scale-95"),e&&e.task_id&&e.task_html?setTimeout(()=>{const t=document.getElementById(`task-${e.task_id}`);if(t){const s=document.querySelector(".grid-table-scrollable"),o=s?s.scrollLeft:0;t.outerHTML=e.task_html;const l=document.getElementById(`task-${e.task_id}`);l&&"undefined"!=typeof htmx&&htmx.process(l),s&&o>0&&(s.scrollLeft=o),setTimeout(()=>{this.syncRowHeights(),s&&o>0&&(s.scrollLeft=o,this.state.dataColWidth>0&&(this.state.currentCol=Math.round(o/this.state.dataColWidth),this.updateScrollButtons()))},10)}else window.location.reload()},300):setTimeout(()=>window.location.reload(),300)}if(t.detail.requestConfig&&"post"===t.detail.requestConfig.verb&&t.target.closest("#modal-content")&&this.elements.scrollable&&sessionStorage.setItem("grid-scroll-position",this.elements.scrollable.scrollLeft.toString()),!t.detail.successful&&t.target.closest('form[hx-post*="toggle"]')){const e=t.target.closest("form").querySelector('input[type="checkbox"][name="completed"]');if(e){const t=e.id.replace("checkbox-",""),s=document.getElementById(`task-text-${t}`);e.checked=!e.checked,s&&(e.checked?(e.classList.add("checkbox-completed"),s.classList.add("task-completed-strikethrough")):(e.classList.remove("checkbox-completed"),s.classList.remove("task-completed-strikethrough")))}}if(t.detail.successful&&t.target.closest('form[hx-post*="toggle"]'))try{const e=JSON.parse(t.detail.xhr.response);if(e.success&&e.hasOwnProperty("completed")){const s=t.target.closest("form").querySelector('input[type="checkbox"][name="completed"]');if(s){const t=s.id.replace("checkbox-",""),o=document.getElementById(`task-text-${t}`);s.checked=e.completed,o&&(e.completed?(s.classList.add("checkbox-completed"),o.classList.add("task-completed-strikethrough")):(s.classList.remove("checkbox-completed"),o.classList.remove("task-completed-strikethrough")))}}}catch(t){}if(t.detail.successful){const e=t.target.closest(".task-form");if(e){const t=e.querySelector('input[name="text"]');t&&(t.value="",e.classList.contains("add-task-form")?this.collapseAddTaskForm(e):t.focus());const s=e.querySelector(".error-message");s&&(s.innerHTML="")}}}handleHtmxAfterSwap(t){if("modal-content"===t.detail.target.id){const e=t.detail.target;this.showModal();const s=e.querySelector('textarea, input[name="text"]');if(s){const t=t=>{if("Enter"===t.key){if("textarea"===s.tagName.toLowerCase()&&t.shiftKey)return;t.preventDefault();const e=s.closest("form");if(e){const t=e.querySelector('button[type="submit"]');t?t.click():e.submit()}}};s.addEventListener("keydown",t),setTimeout(()=>{s.focus(),s.setSelectionRange(s.value.length,s.value.length)},150)}}t.detail.target&&t.detail.target.closest('[id^="tasks-"]')&&void 0!==window._hyperscript&&window._hyperscript.processNode(t.detail.target);const e=t.detail.target&&"modal-content"===t.detail.target.id,s=t.detail.target&&t.detail.target.closest("#grid-content"),o=t.detail.target&&t.detail.target.closest('[id^="task-"]');e?("undefined"!=typeof htmx&&htmx.process(t.detail.target),this.reinitializeComponents()):s&&!o&&setTimeout(()=>this.syncRowHeights(),10)}handleHtmxAfterSettle(t){const e=t.detail.target&&(t.detail.target.closest("#grid-content")||t.detail.target.closest(".task-form")),s=t.detail.target&&t.detail.target.closest('[id^="task-"]');if(e&&!s){const t=this.elements.scrollable?this.elements.scrollable.scrollLeft:0;setTimeout(()=>{this.syncRowHeights(),this.elements.scrollable&&this.elements.scrollable.scrollLeft!==t&&(this.elements.scrollable.scrollLeft=t)},10)}}handleHtmxError(t){t.detail.target&&"modal-content"===t.detail.target.id&&(this.elements.modalContent.innerHTML='\n                <div class="flex items-center justify-center p-8">\n                    <div class="flex flex-col items-center space-y-3 text-center">\n                        <div class="w-12 h-12 bg-red-100 rounded-full flex items-center justify-center">\n                            <i class="fas fa-exclamation-triangle text-red-500 text-xl"></i>\n                        </div>\n                        <div>\n                            <h3 class="text-lg font-medium text-[var(--text-primary)]">Error Loading Content</h3>\n                            <p class="text-sm text-[var(--text-secondary)] mt-1">Unable to load the requested content. Please try again.</p>\n                        </div>\n                        <button type="button" \n                                class="close-modal mt-4 px-4 py-2 bg-[var(--primary-action-bg)] hover:bg-[var(--primary-action-hover-bg)] text-white rounded-lg transition-colors">\n                            Close\n                        </button>\n                    </div>\n                </div>\n            ')}reinitializeComponents(){const t=this.elements.scrollable?this.elements.scrollable.scrollLeft:0;this.cacheElements(),this.setupGridScrolling(!0),this.elements.scrollable&&t>0&&(this.elements.scrollable.scrollLeft=t,this.state.currentCol=this.state.dataColWidth>0?Math.round(t/this.state.dataColWidth):0,this.updateScrollButtons())}cleanup(){this.resizeTimeout&&clearTimeout(this.resizeTimeout),this.eventListeners.forEach((t,e)=>{t.forEach(({event:t,handler:s})=>{e.removeEventListener(t,s)})}),this.eventListeners.clear(),this.observers.forEach(t=>t.disconnect()),this.observers.clear()}init(){this.cacheElements(),this.setInitialColumnVisibility(),this.elements.gridTable&&this.elements.gridTable.classList.add("initialized"),this.addEventListeners(),this.setupGridScrolling(),"undefined"!=typeof htmx&&(htmx.config.disableSelector="[hx-disable]",htmx.config.useTemplateFragments=!1),this.calculateAndApplyWidths(),setTimeout(()=>{this.calculateAndApplyWidths()},100),setTimeout(()=>{this.calculateAndApplyWidths(),this.syncRowHeights()},500)}setInitialColumnVisibility(){const t=document.querySelectorAll(".data-column");if(!t.length)return;const e=this.getResponsiveColumnCount();t.forEach((t,s)=>{if(s<e){const e=0===s?"300px":"250px";t.style.width=e,t.style.minWidth=e,t.style.maxWidth="none",t.style.overflow="visible"}else t.style.width="0",t.style.minWidth="0",t.style.maxWidth="0",t.style.overflow="hidden"}),this.elements.scrollable&&this.elements.scrollable.offsetHeight}}function validateTaskForm(t){const e=t.querySelector('input[name="text"]'),s=t.querySelector(".error-message");return e.value.trim()?(s.innerHTML="",e.classList.remove("border-red-500"),e.classList.add("border-[var(--inline-input-border)]"),!0):(s.innerHTML="Please enter a task description",e.classList.remove("border-[var(--inline-input-border)]"),e.classList.add("border-red-500"),e.focus(),!1)}document.addEventListener("DOMContentLoaded",function(){window.gridManager=new GridManager}),window.closeAllDropdowns=function(){window.gridManager&&window.gridManager.closeAllDropdowns()},window.addEventListener("beforeunload",function(){window.gridManager&&window.gridManager.cleanup()});