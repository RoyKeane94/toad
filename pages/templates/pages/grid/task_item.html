{% load static %}
<div class="task-item bg-[var(--task-bg)] hover:bg-[var(--task-hover-bg)] p-3 rounded-md shadow-sm transition-all duration-200 group {% if task.completed %}completed{% endif %}" 
     data-task-id="{{ task.id }}"
     id="task-{{ task.id }}">
    <div class="flex items-center justify-between w-full">
        <div class="flex items-center space-x-3 min-w-0 flex-1">
            <form method="POST" 
                  action="{% url 'pages:task_toggle_complete' task.pk %}" 
                  class="flex-shrink-0"
                  hx-post="{% url 'pages:task_toggle_complete' task.pk %}"
                  hx-swap="none"
                  hx-trigger="change"
                  hx-indicator=".htmx-indicator-{{ task.id }}"
                  _="on htmx:afterRequest(detail) 
                     if detail.successful
                       set response to JSON.parse(detail.xhr.response)
                       if response.completed
                         add .completed to #task-{{ task.id }}
                       else
                         remove .completed from #task-{{ task.id }}
                       end
                     end">
                {% csrf_token %}
                <input type="checkbox" 
                       name="completed" 
                       {% if task.completed %}checked{% endif %}
                       class="w-4 h-4 rounded border-gray-300 text-[var(--primary-action-bg)] focus:ring-[var(--primary-action-bg)]">
                <div class="htmx-indicator-{{ task.id }} htmx-indicator-spinner"></div>
            </form>
            <p class="text-sm text-[var(--text-primary)]">{{ task.text }}</p>
        </div>
        
        <!-- Actions -->
        <div class="flex-shrink-0 flex space-x-1 opacity-0 group-hover:opacity-100 transition-opacity duration-200">
            <a href="{% url 'pages:task_edit' task_pk=task.pk %}" 
               class="p-1 hover:bg-[var(--container-bg)] rounded transition-colors" title="Edit task">
                <i class="fas fa-edit text-xs text-[var(--text-secondary)] hover:text-[var(--primary-action-bg)]"></i>
            </a>
            <button type="button" 
                    class="p-1 hover:bg-red-50 rounded transition-colors delete-task-btn" 
                    title="Delete task"
                    data-task-id="{{ task.pk }}"
                    data-task-text="{{ task.text }}"
                    data-delete-url="{% url 'pages:task_delete' task_pk=task.pk %}">
                <i class="fas fa-trash text-xs text-[var(--text-secondary)] hover:text-[var(--delete-button-bg)]"></i>
            </button>
        </div>
    </div>
</div> 