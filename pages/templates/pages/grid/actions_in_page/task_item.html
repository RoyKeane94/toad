{% load static %}
<div class="group flex items-center justify-between w-full p-2 rounded-lg hover:bg-[var(--grid-header-bg)] transition-all duration-200 {% if task.completed %}bg-green-50{% endif %}"
     data-task-id="{{ task.id }}"
     id="task-{{ task.id }}">
    <div class="flex items-center space-x-3 min-w-0 flex-1">
        <form method="POST" 
              action="{% url 'pages:task_toggle_complete' task.pk %}" 
              class="flex-shrink-0"
              hx-post="{% url 'pages:task_toggle_complete' task.pk %}"
              hx-swap="none"
              hx-trigger="change"
              _="on htmx:afterRequest(detail) 
                 if detail.successful
                   set response to JSON.parse(detail.xhr.response)
                   if response.completed
                     add .bg-green-50 to #task-{{ task.id }}
                     add .line-through to #task-text-{{ task.id }}
                     add .text-gray-500 to #task-text-{{ task.id }}
                   else
                     remove .bg-green-50 from #task-{{ task.id }}
                     remove .line-through from #task-text-{{ task.id }}
                     remove .text-gray-500 from #task-text-{{ task.id }}
                   end
                 end">
            {% csrf_token %}
            <input type="checkbox" 
                   name="completed" 
                   {% if task.completed %}checked{% endif %}
                   class="w-4 h-4 rounded border-gray-300 text-[var(--primary-action-bg)] focus:ring-[var(--primary-action-bg)] cursor-pointer">
        </form>
        <p id="task-text-{{ task.id }}" class="text-sm text-[var(--text-primary)] {% if task.completed %}line-through text-gray-500{% endif %}">{{ task.text }}</p>
    </div>
    
    <!-- Actions -->
    <div class="flex-shrink-0 flex space-x-1 opacity-0 group-hover:opacity-100 transition-opacity duration-200">
        <button type="button"
                class="p-1 rounded hover:bg-[var(--grid-header-bg)] transition-colors cursor-pointer" 
                title="Edit task"
                hx-get="{% url 'pages:task_edit' task_pk=task.pk %}"
                hx-target="#modal-content"
                hx-trigger="click"
                _="on click trigger openModal">
            <i class="fas fa-edit text-xs text-[var(--text-secondary)] hover:text-[var(--primary-action-bg)]"></i>
        </button>
        <button type="button"
                class="delete-task-btn p-1 rounded hover:bg-[var(--grid-header-bg)] transition-colors cursor-pointer" 
                title="Delete task"
                data-task-id="{{ task.pk }}"
                data-task-text="{{ task.text }}"
                data-delete-url="{% url 'pages:task_delete' task_pk=task.pk %}">
            <i class="fas fa-trash text-xs text-[var(--text-secondary)] hover:text-[var(--delete-button-bg)]"></i>
        </button>
    </div>
</div> 